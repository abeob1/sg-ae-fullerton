[07/27/2016 16:31:29][                                  Main()] Starting Addon startup function
[07/27/2016 16:31:29][                                  Main()] Initializing public SBO Application object
[07/27/2016 16:31:29][                                  Main()] Retriving SBO application company handle
[07/27/2016 16:31:30][                                  Main()] Retrived SBO application company handle
[07/27/2016 16:31:30][                                  Main()] Calling ConnectDICompSSO()
[07/27/2016 16:31:30][                      ConnectDICompSSO()] Starting function
[07/27/2016 16:31:34][                      ConnectDICompSSO()] Completed with SUCCESS
[07/27/2016 16:31:34][                                  Main()] Creating Event handler class
[07/27/2016 16:31:34][                      Class_Initialize()] Starting function
[07/27/2016 16:31:34][                      Class_Initialize()] Retriving SBO Application handle
[07/27/2016 16:31:34][                      Class_Initialize()] Completed with SUCCESS
[07/27/2016 16:31:34][                                  Main()] Calling AddMenuItems()
[07/27/2016 16:31:35][                                  Main()] Creating tables
[07/27/2016 16:31:36][                                  Main()] Starting Function
[07/27/2016 16:31:36][                                  Main()] Completed with SUCCESS
[07/27/2016 16:31:36][                               AssignFMS] Starting Function
[07/27/2016 16:31:36][                               AssignFMS] Error while creating FMS
[07/27/2016 16:31:36][                               AssignFMS] Completed with SUCCESS
[07/27/2016 16:31:36][                               AssignFMS] Starting Function
[07/27/2016 16:31:36][                               AssignFMS] Error while creating FMS
[07/27/2016 16:31:36][                               AssignFMS] Completed with SUCCESS
[07/27/2016 16:31:36][                                  Main()] Addon started successfully
[07/27/2016 16:44:40][                                  Main()] Starting Addon startup function
[07/27/2016 16:44:40][                                  Main()] Initializing public SBO Application object
[07/27/2016 16:44:40][                                  Main()] Retriving SBO application company handle
[07/27/2016 16:44:42][                                  Main()] Retrived SBO application company handle
[07/27/2016 16:44:42][                                  Main()] Calling ConnectDICompSSO()
[07/27/2016 16:44:42][                      ConnectDICompSSO()] Starting function
[07/27/2016 16:44:46][                      ConnectDICompSSO()] Completed with SUCCESS
[07/27/2016 16:44:46][                                  Main()] Creating Event handler class
[07/27/2016 16:44:46][                      Class_Initialize()] Starting function
[07/27/2016 16:44:46][                      Class_Initialize()] Retriving SBO Application handle
[07/27/2016 16:44:46][                      Class_Initialize()] Completed with SUCCESS
[07/27/2016 16:44:46][                                  Main()] Calling AddMenuItems()
[07/27/2016 16:44:46][                                  Main()] Creating tables
[07/27/2016 16:44:46][                                  Main()] Starting Function
[07/27/2016 16:44:46][                                  Main()] Completed with SUCCESS
[07/27/2016 16:44:46][                               AssignFMS] Starting Function
[07/27/2016 16:44:46][                               AssignFMS] Error while creating FMS
[07/27/2016 16:44:46][                               AssignFMS] Completed with SUCCESS
[07/27/2016 16:44:46][                               AssignFMS] Starting Function
[07/27/2016 16:44:46][                               AssignFMS] Error while creating FMS
[07/27/2016 16:44:46][                               AssignFMS] Completed with SUCCESS
[07/27/2016 16:44:46][                                  Main()] Addon started successfully
[07/27/2016 16:47:13][                                  Main()] Starting Addon startup function
[07/27/2016 16:47:13][                                  Main()] Initializing public SBO Application object
[07/27/2016 16:47:13][                                  Main()] Retriving SBO application company handle
[07/27/2016 16:47:14][                                  Main()] Retrived SBO application company handle
[07/27/2016 16:47:14][                                  Main()] Calling ConnectDICompSSO()
[07/27/2016 16:47:14][                      ConnectDICompSSO()] Starting function
[07/27/2016 16:47:18][                      ConnectDICompSSO()] Completed with SUCCESS
[07/27/2016 16:47:18][                                  Main()] Creating Event handler class
[07/27/2016 16:47:18][                      Class_Initialize()] Starting function
[07/27/2016 16:47:18][                      Class_Initialize()] Retriving SBO Application handle
[07/27/2016 16:47:18][                      Class_Initialize()] Completed with SUCCESS
[07/27/2016 16:47:18][                                  Main()] Calling AddMenuItems()
[07/27/2016 16:47:18][                                  Main()] Creating tables
[07/27/2016 16:47:18][                                  Main()] Starting Function
[07/27/2016 16:47:18][                                  Main()] Completed with SUCCESS
[07/27/2016 16:47:18][                               AssignFMS] Starting Function
[07/27/2016 16:47:18][                               AssignFMS] Error while creating FMS
[07/27/2016 16:47:18][                               AssignFMS] Completed with SUCCESS
[07/27/2016 16:47:18][                               AssignFMS] Starting Function
[07/27/2016 16:47:18][                               AssignFMS] Error while creating FMS
[07/27/2016 16:47:18][                               AssignFMS] Completed with SUCCESS
[07/27/2016 16:47:18][                                  Main()] Addon started successfully
[07/27/2016 16:48:07][                                  Main()] Starting Addon startup function
[07/27/2016 16:48:07][                                  Main()] Initializing public SBO Application object
[07/27/2016 16:48:07][                                  Main()] Retriving SBO application company handle
[07/27/2016 16:48:08][                                  Main()] Retrived SBO application company handle
[07/27/2016 16:48:08][                                  Main()] Calling ConnectDICompSSO()
[07/27/2016 16:48:08][                      ConnectDICompSSO()] Starting function
[07/27/2016 16:48:12][                      ConnectDICompSSO()] Completed with SUCCESS
[07/27/2016 16:48:12][                                  Main()] Creating Event handler class
[07/27/2016 16:48:12][                      Class_Initialize()] Starting function
[07/27/2016 16:48:12][                      Class_Initialize()] Retriving SBO Application handle
[07/27/2016 16:48:12][                      Class_Initialize()] Completed with SUCCESS
[07/27/2016 16:48:12][                                  Main()] Calling AddMenuItems()
[07/27/2016 16:48:12][                                  Main()] Creating tables
[07/27/2016 16:48:12][                                  Main()] Starting Function
[07/27/2016 16:48:12][                                  Main()] Completed with SUCCESS
[07/27/2016 16:48:12][                               AssignFMS] Starting Function
[07/27/2016 16:48:12][                               AssignFMS] Error while creating FMS
[07/27/2016 16:48:12][                               AssignFMS] Completed with SUCCESS
[07/27/2016 16:48:12][                               AssignFMS] Starting Function
[07/27/2016 16:48:12][                               AssignFMS] Error while creating FMS
[07/27/2016 16:48:12][                               AssignFMS] Completed with SUCCESS
[07/27/2016 16:48:12][                                  Main()] Addon started successfully
[08/03/2016 15:13:45][                                  Main()] Starting Addon startup function
[08/03/2016 15:13:45][                                  Main()] Initializing public SBO Application object
[08/03/2016 15:13:45][                                  Main()] Retriving SBO application company handle
[08/03/2016 15:13:46][                                  Main()] Retrived SBO application company handle
[08/03/2016 15:13:46][                                  Main()] Calling ConnectDICompSSO()
[08/03/2016 15:13:46][                      ConnectDICompSSO()] Starting function
[08/03/2016 15:13:51][                      ConnectDICompSSO()] Completed with SUCCESS
[08/03/2016 15:13:51][                                  Main()] Creating Event handler class
[08/03/2016 15:13:51][                      Class_Initialize()] Starting function
[08/03/2016 15:13:51][                      Class_Initialize()] Retriving SBO Application handle
[08/03/2016 15:13:51][                      Class_Initialize()] Completed with SUCCESS
[08/03/2016 15:13:51][                                  Main()] Calling AddMenuItems()
[08/03/2016 15:13:51][                                  Main()] Creating tables
[08/03/2016 15:13:51][                                  Main()] Starting Function
[08/03/2016 15:13:51][                                  Main()] Completed with SUCCESS
[08/03/2016 15:13:51][                               AssignFMS] Starting Function
[08/03/2016 15:13:51][                               AssignFMS] Error while creating FMS
[08/03/2016 15:13:51][                               AssignFMS] Completed with SUCCESS
[08/03/2016 15:13:51][                               AssignFMS] Starting Function
[08/03/2016 15:13:51][                               AssignFMS] Error while creating FMS
[08/03/2016 15:13:51][                               AssignFMS] Completed with SUCCESS
[08/03/2016 15:13:51][                                  Main()] Addon started successfully
[08/03/2016 15:14:20][                         GenerateCSVFile] Starting Function
[08/03/2016 15:14:20][                  CreateProcedure_Entity] Starting Function
[08/03/2016 15:14:20][                            ExecuteQuery] Executing SQL SELECT COUNT("PROCEDURE_NAME") AS "MNO" FROM "PROCEDURES" WHERE "SCHEMA_NAME"  = 'SBODEMOUS' AND "PROCEDURE_NAME" = 'AE_SP001_AnaplanTrailBalExtraction_Addon'
[08/03/2016 15:14:20][                         ExecuteNonQuery] Executing SQL CREATE PROCEDURE "AE_SP001_AnaplanTrailBalExtraction_Addon"
(
 IN FromDate DATE,
IN ToDate DATE,
IN AnaPlanCode VARCHAR
)

AS

DateFrom VARCHAR(20);
DateTo VARCHAR(20);


BEGIN

 DateFrom:=TO_CHAR(:FromDate ,'YYYY-MM-DD');
 DateTo:=TO_CHAR(:ToDate ,'YYYY-MM-DD');

CREATE COLUMN TABLE "TBEXTRACT" (ReportingUnit varchar(100)
								,ICPartnerCode Varchar(200),AcctCode varchar(200)
								,Movement varchar(10),Amount Decimal);
								
CREATE COLUMN TABLE "TBFINAL" (ReportingDate VARCHAR(20),ReportingUnit varchar(100)
								,ICPartnerCode Varchar(200),AcctCode varchar(200)
								,Movement varchar(10),Amount Decimal);								
--================================ Balance Amount ==================================================================
INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<=:DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(4,5,6,7,8)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<=:DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(4,5,6,7,8)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


--=================================== Opening Balance ==========================================================================
INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M00' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<:DateFrom AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M00' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<:DateFrom AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


--================================== Debit Amount ===============================================================

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M05' AS "Movement"
,SUM(T0."Debit")  AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M05' AS "Movement"
,SUM(T0."Debit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo 
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


--=================================== Credit Amout ==========================================================================

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M06' AS "Movement"
,-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M06' AS "Movement"
,-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo 
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");

--=============================================================================================================
INSERT INTO "TBFINAL"(
SELECT 
TO_CHAR(:DateTo,'DD-MM-YYYY')AS "Reporting Date"
--,:CompanyCode AS "Anaplan Entity Code"
,:AnaPlanCode AS "Anaplan Entity Code"
----,MAX(T0."REPORTINGUNIT")
,T0."ICPARTNERCODE"
,T0."ACCTCODE"
,T0."MOVEMENT"
,SUM(T0."AMOUNT")

 FROM "TBEXTRACT" T0 GROUP BY T0."ICPARTNERCODE",T0."ACCTCODE"
,T0."MOVEMENT");
 
  
SELECT T0."REPORTINGDATE" AS "Trans date",T0."REPORTINGUNIT" AS "Reporting unit"
,T0."ICPARTNERCODE" AS "IC Partner", T0."ACCTCODE" AS "Local Account"
,T0."MOVEMENT" AS "Movement", T0."AMOUNT" AS "Amount" 
FROM "TBFINAL" T0 
ORDER BY T0."ACCTCODE",T0."ICPARTNERCODE";

DROP TABLE "TBEXTRACT";
DROP TABLE "TBFINAL";

END;
[08/03/2016 15:14:20][                         ExecuteNonQuery] Execute Query Error
[08/03/2016 15:14:20][                  CreateProcedure_Entity] Completed with ERROR
[08/03/2016 15:14:20][                            ExecuteQuery] Executing SQL CALL SBODEMOUS."AE_SP001_AnaplanTrailBalExtraction_Addon"('2016-08-03','2016-08-03','')
[08/03/2016 15:14:20][                            ExecuteQuery] Execute Query Error
[08/03/2016 15:14:20][                         GenerateCSVFile] Completed with ERROR
[08/03/2016 15:14:50][                         GenerateCSVFile] Starting Function
[08/03/2016 15:15:06][                  CreateProcedure_Entity] Starting Function
[08/03/2016 15:15:06][                            ExecuteQuery] Executing SQL SELECT COUNT("PROCEDURE_NAME") AS "MNO" FROM "PROCEDURES" WHERE "SCHEMA_NAME"  = 'SBODEMOUS' AND "PROCEDURE_NAME" = 'AE_SP001_AnaplanTrailBalExtraction_Addon'
[08/03/2016 15:15:06][                         ExecuteNonQuery] Executing SQL CREATE PROCEDURE "AE_SP001_AnaplanTrailBalExtraction_Addon"
(
 IN FromDate DATE,
IN ToDate DATE,
IN AnaPlanCode VARCHAR
)

AS

DateFrom VARCHAR(20);
DateTo VARCHAR(20);


BEGIN

 DateFrom:=TO_CHAR(:FromDate ,'YYYY-MM-DD');
 DateTo:=TO_CHAR(:ToDate ,'YYYY-MM-DD');

CREATE COLUMN TABLE "TBEXTRACT" (ReportingUnit varchar(100)
								,ICPartnerCode Varchar(200),AcctCode varchar(200)
								,Movement varchar(10),Amount Decimal);
								
CREATE COLUMN TABLE "TBFINAL" (ReportingDate VARCHAR(20),ReportingUnit varchar(100)
								,ICPartnerCode Varchar(200),AcctCode varchar(200)
								,Movement varchar(10),Amount Decimal);								
--================================ Balance Amount ==================================================================
INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<=:DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(4,5,6,7,8)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<=:DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(4,5,6,7,8)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


--=================================== Opening Balance ==========================================================================
INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M00' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<:DateFrom AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M00' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<:DateFrom AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


--================================== Debit Amount ===============================================================

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M05' AS "Movement"
,SUM(T0."Debit")  AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M05' AS "Movement"
,SUM(T0."Debit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo 
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


--=================================== Credit Amout ==========================================================================

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M06' AS "Movement"
,-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M06' AS "Movement"
,-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo 
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");

--=============================================================================================================
INSERT INTO "TBFINAL"(
SELECT 
TO_CHAR(:DateTo,'DD-MM-YYYY')AS "Reporting Date"
--,:CompanyCode AS "Anaplan Entity Code"
,:AnaPlanCode AS "Anaplan Entity Code"
----,MAX(T0."REPORTINGUNIT")
,T0."ICPARTNERCODE"
,T0."ACCTCODE"
,T0."MOVEMENT"
,SUM(T0."AMOUNT")

 FROM "TBEXTRACT" T0 GROUP BY T0."ICPARTNERCODE",T0."ACCTCODE"
,T0."MOVEMENT");
 
  
SELECT T0."REPORTINGDATE" AS "Trans date",T0."REPORTINGUNIT" AS "Reporting unit"
,T0."ICPARTNERCODE" AS "IC Partner", T0."ACCTCODE" AS "Local Account"
,T0."MOVEMENT" AS "Movement", T0."AMOUNT" AS "Amount" 
FROM "TBFINAL" T0 
ORDER BY T0."ACCTCODE",T0."ICPARTNERCODE";

DROP TABLE "TBEXTRACT";
DROP TABLE "TBFINAL";

END;
[08/03/2016 15:15:06][                         ExecuteNonQuery] Execute Query Error
[08/03/2016 15:15:06][                  CreateProcedure_Entity] Completed with ERROR
[08/03/2016 15:15:18][                  CreateProcedure_Entity] Starting Function
[08/03/2016 15:16:09][                            ExecuteQuery] Executing SQL SELECT COUNT("PROCEDURE_NAME") AS "MNO" FROM "PROCEDURES" WHERE "SCHEMA_NAME"  = 'SBODEMOUS' AND "PROCEDURE_NAME" = 'AE_SP001_AnaplanTrailBalExtraction_Addon'
[08/03/2016 15:16:32][                            ExecuteQuery] Executing SQL SELECT COUNT("PROCEDURE_NAME") AS "MNO" FROM "PROCEDURES" WHERE "SCHEMA_NAME"  = 'SBODEMOUS' AND "PROCEDURE_NAME" = 'AE_SP001_AnaplanTrailBalExtraction_Addon'
[08/03/2016 15:16:56][                         ExecuteNonQuery] Executing SQL CREATE PROCEDURE "AE_SP001_AnaplanTrailBalExtraction_Addon"
(
 IN FromDate DATE,
IN ToDate DATE,
IN AnaPlanCode VARCHAR
)

AS

DateFrom VARCHAR(20);
DateTo VARCHAR(20);


BEGIN

 DateFrom:=TO_CHAR(:FromDate ,'YYYY-MM-DD');
 DateTo:=TO_CHAR(:ToDate ,'YYYY-MM-DD');

CREATE COLUMN TABLE "TBEXTRACT" (ReportingUnit varchar(100)
								,ICPartnerCode Varchar(200),AcctCode varchar(200)
								,Movement varchar(10),Amount Decimal);
								
CREATE COLUMN TABLE "TBFINAL" (ReportingDate VARCHAR(20),ReportingUnit varchar(100)
								,ICPartnerCode Varchar(200),AcctCode varchar(200)
								,Movement varchar(10),Amount Decimal);								
--================================ Balance Amount ==================================================================
INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<=:DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(4,5,6,7,8)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<=:DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(4,5,6,7,8)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


--=================================== Opening Balance ==========================================================================
INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M00' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<:DateFrom AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M00' AS "Movement"
,SUM(T0."Debit")-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate"<:DateFrom AND T0."TransType"<>-3
AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


--================================== Debit Amount ===============================================================

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M05' AS "Movement"
,SUM(T0."Debit")  AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M05' AS "Movement"
,SUM(T0."Debit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo 
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


--=================================== Credit Amout ==========================================================================

INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M06' AS "Movement"
,-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)='Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");


INSERT INTO "TBEXTRACT"(
								
SELECT
T0."ShortName",
T1."U_ANAPLANICCODE" AS "Anaplan IC Code"
,T0."Account"
,'M06' AS "Movement"
,-SUM(T0."Credit") AS "Amount"

FROM 
"JDT1" T0
LEFT JOIN "OCRD" T1 ON T0."ShortName"=T1."CardCode"
RIGHT JOIN "OACT" T2 ON T0."Account"=T2."AcctCode"

WHERE T0."RefDate" BETWEEN :DateFrom AND :DateTo 
AND T0."TransType"<>-3 AND LEFT (T0."ShortName",1)<>'Z' AND T2."Frozen"='N' AND T2."GroupMask" IN(1,2,3)
GROUP BY T0."Account",T2."AcctCode",T1."U_ANAPLANICCODE",T0."ShortName");

--=============================================================================================================
INSERT INTO "TBFINAL"(
SELECT 
TO_CHAR(:DateTo,'DD-MM-YYYY')AS "Reporting Date"
--,:CompanyCode AS "Anaplan Entity Code"
,:AnaPlanCode AS "Anaplan Entity Code"
----,MAX(T0."REPORTINGUNIT")
,T0."ICPARTNERCODE"
,T0."ACCTCODE"
,T0."MOVEMENT"
,SUM(T0."AMOUNT")

 FROM "TBEXTRACT" T0 GROUP BY T0."ICPARTNERCODE",T0."ACCTCODE"
,T0."MOVEMENT");
 
  
SELECT T0."REPORTINGDATE" AS "Trans date",T0."REPORTINGUNIT" AS "Reporting unit"
,T0."ICPARTNERCODE" AS "IC Partner", T0."ACCTCODE" AS "Local Account"
,T0."MOVEMENT" AS "Movement", T0."AMOUNT" AS "Amount" 
FROM "TBFINAL" T0 
ORDER BY T0."ACCTCODE",T0."ICPARTNERCODE";

DROP TABLE "TBEXTRACT";
DROP TABLE "TBFINAL";

END;
[08/03/2016 15:17:22][                         ExecuteNonQuery] Execute Query Error
[08/03/2016 15:17:22][                  CreateProcedure_Entity] Completed with ERROR
[08/03/2016 15:17:22][                            ExecuteQuery] Executing SQL CALL SBODEMOUS."AE_SP001_AnaplanTrailBalExtraction_Addon"('2016-08-03','2016-08-03','')
[08/03/2016 15:17:22][                            ExecuteQuery] Execute Query Error
[08/03/2016 15:17:22][                         GenerateCSVFile] Completed with ERROR
[08/03/2016 15:17:22][                       GTB_SBO_ItemEvent] Completed with ERROR
[08/03/2016 15:17:22][             SBO_Application_ItemEvent()] Completed with ERROR
